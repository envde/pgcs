namespace PgCs.Core.Types.Base;

/// <summary>
/// Волатильность функции PostgreSQL
/// </summary>
/// <remarks>
/// Влияет на оптимизацию запросов и кэширование результатов.
/// PostgreSQL использует эту информацию для принятия решений об оптимизации.
/// </remarks>
public enum PgFunctionVolatility
{
    /// <summary>
    /// VOLATILE - функция может возвращать разные результаты для одинаковых аргументов
    /// </summary>
    /// <example>random(), now(), currval()</example>
    /// <remarks>
    /// - Не кэшируется
    /// - Не может быть использована в индексах
    /// - Вызывается для каждой строки
    /// </remarks>
    Volatile,

    /// <summary>
    /// STABLE - функция возвращает одинаковые результаты в пределах одного запроса
    /// </summary>
    /// <example>current_timestamp, age(timestamp)</example>
    /// <remarks>
    /// - Вызывается один раз за запрос для одинаковых аргументов
    /// - Может быть использована в индексных выражениях
    /// - Безопасна для использования в WHERE
    /// </remarks>
    Stable,

    /// <summary>
    /// IMMUTABLE - функция всегда возвращает одинаковые результаты для одинаковых аргументов
    /// </summary>
    /// <example>abs(), sqrt(), lower()</example>
    /// <remarks>
    /// - Полностью кэшируется
    /// - Может быть вычислена на этапе планирования
    /// - Требуется для функциональных индексов
    /// - Самая агрессивная оптимизация
    /// </remarks>
    Immutable
}
